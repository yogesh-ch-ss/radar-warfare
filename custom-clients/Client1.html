<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>STOMP WebSocket Test</title>
        <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    </head>
    <body>
        <button onclick="connect()">Connect</button>
        <button onclick="join()">Join Matchmaking</button>

        <script>
            const player = { playerId: "player1" };
            let stompClient = null;

            function connect() {
                const socket = new SockJS("http://localhost:8080/ws");
                stompClient = Stomp.over(socket);

                stompClient.connect({}, function (frame) {
                    console.log("Connected: " + frame);

                    stompClient.subscribe(
                        "/subscribe/match/" + player.playerId,
                        function (message) {
                            const matchInfo = JSON.parse(message.body);
                            console.log(
                                "Match Found for " + playerId + ":",
                                matchInfo
                            );
                        }
                    );
                });
            }

            function join() {
                stompClient.send(
                    "/matchmaking/join",
                    {},
                    JSON.stringify(player)
                );
            }
        </script>
    </body>
</html>
